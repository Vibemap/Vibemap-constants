{"version":3,"file":"nlp.js","sources":["../utils/nlp.js"],"sourcesContent":["const tokenizer = require('wink-tokenizer')\nconst { similarity} = require('@nlpjs/similarity')\n\nimport Fuse from 'fuse.js'\n\nconst vibes = require('../dist/vibes.js')\n\n// Get vibe attributes\nexport const getTokens = (\n  content = '@superman: hit me up on my email r2d2@gmail.com, 2 of us plan partyüéâ tom at 3pm:) #fun'\n  ) => {\n  const Tokenizer = tokenizer()\n\n  const tokens = Tokenizer.tokenize(content);\n\n  //console.log('Tokens ', tokens);\n\n  return tokens\n}\n\n// Fuzzy matching of strings\nexport const fuzzyMatch = (list, searchTerm, key) => {\n  let options = {\n    includeScore: true,\n    keys: ['value', 'name'],\n  }\n\n  if (key) options.keys.push(key)\n\n  const fuse = new Fuse(list, options)\n  const results = fuse.search(searchTerm)\n\n  const filter_results = results.filter((result) => {\n    if (result.score < 0.3) return true\n    return false\n  }, [])\n\n  const top_results = filter_results.map((result) => result.item)\n\n  return top_results\n}\n\n\n// This uses an advanced levenstein technique\n// TODO: Use a complete word network like we do with spacy.\nexport const getSimilarity = (word1 = 'chill', word2 = 'chill') => {\n  const distance = similarity(word1, word2)\n  //console.log(`${word1} vs ${word2} distance `, distance)\n  return distance\n}\n\nexport const getSimilarVibes = (word = 'chill') => {\n  const allVibes = vibes.getVibes('keys')\n\n  const vibesWithRelated = allVibes.flatMap(vibe => {\n    const distance = getSimilarity(word, vibe)\n\n    const similarEnough = (distance == 0 || (distance == 1 && word.length > 3))\n    if (similarEnough) {\n      console.log(`- very similar `, word, vibe, distance);\n      return [vibe]\n    } else {\n      return []\n    }\n\n  })\n\n  return vibesWithRelated\n}\n\nexport const getAllSimilarVibes = (\n  content = `<p><em>Looking for a great night out with cheap drinks, chill vibes, and an unpretentious atmosphere? We‚Äôve got you covered</em>.</p><p>The debate around the precise definition of a ‚Äúdive bar‚Äù is spirited, even contentious. Wikipedia describes it as a small, unglamorous, eclectic, and old-style bar. Some say the line between a dive bar and a regular bar is its level of disrepute. For this guide, we define it as a place with three things: cheap drinks, chill vibes, and an unpretentious atmosphere.&nbsp;</p><p>Chances are high you‚Äôre not going to get your culinary socks knocked off at a dive bar. And if you ask for a gluten-free option you are liable to get laughed at. But there‚Äôs no better kind of place to go to spend a good night out with good friends and interesting strangers. So if you‚Äôre looking for a cool dive bar in Oakland, look no further than this handy guide.</p>`) => {\n  const tokens = getTokens(content)\n  const words = tokens.map(token => token.value)\n\n  const vibes = words.flatMap(word => {\n    return getSimilarVibes(word)\n  })\n\n  console.log(`Found these vibes `, vibes);\n}\n\n\n"],"names":["tokenizer","require","similarity","vibes","getTokens","content","Tokenizer","tokenize","fuzzyMatch","list","searchTerm","key","let","options","includeScore","keys","push","fuse","Fuse","results","search","filter_results","filter","result","score","map","item","getSimilarity","word1","word2","getSimilarVibes","word","allVibes","getVibes","flatMap","vibe","distance","length","console","log","getAllSimilarVibes","tokens","words","token","value"],"mappings":"0OAAA,MAAMA,UAAYC,QAAQ,kBAClBC,WAAcD,QAAQ,qBAAtBC,cAIFC,MAAQF,QAAQ,oBAGTG,UAAY,CACvBC,EAAU,6FAEV,MAAMC,EAAYN,YAMlB,OAJeM,EAAUC,SAASF,IAQvBG,WAAa,CAACC,EAAMC,EAAYC,KAC3CC,IAAIC,EAAU,CACZC,cAAc,EACdC,KAAM,CAAC,QAAS,SAGdJ,GAAKE,EAAQE,KAAKC,KAAKL,GAE3B,MAAMM,EAAO,IAAIC,sBAAKT,EAAMI,GACtBM,EAAUF,EAAKG,OAAOV,GAEtBW,EAAiBF,EAAQG,OAAO,GAChCC,EAAOC,MAAQ,GAElB,IAIH,OAFoBH,EAAeI,IAAI,GAAYF,EAAOG,OAQ/CC,cAAgB,CAACC,EAAQ,QAASC,EAAQ,WAGrD,OAFiB3B,WAAW0B,EAAOC,IAKxBC,gBAAkB,CAACC,EAAO,WACrC,MAAMC,EAAW7B,MAAM8B,SAAS,QAehC,OAbyBD,EAASE,QAAQC,IACxC,IAAMC,EAAWT,cAAcI,EAAMI,GAGrC,OADmC,GAAZC,GAA8B,GAAZA,GAA+B,EAAdL,EAAKM,QAE7DC,QAAQC,IAAI,kBAAmBR,EAAMI,EAAMC,GACpC,CAACD,IAED,MAQAK,mBAAqB,CAChCnC,EAAU,03BACV,MAAMoC,EAASrC,UAAUC,GACnBqC,EAAQD,EAAOhB,IAAIkB,GAASA,EAAMC,OAElCzC,EAAQuC,EAAMR,QAAQH,GACnBD,gBAAgBC,IAGzBO,QAAQC,IAAI,qBAAsBpC"}